<!-- BEGIN: content -->

    <!-- BEGIN: preview -->
    <fieldset id="component-redirect" class="component-preview qrcode">
        <div id="qr-code-loading" class="onyx-loading htmx-indicator">
            <img src="/share/images/loading.svg" alt="Loading..."/>
        </div>
            
        <legend>Redirect</legend>

        <span class="label">This page redirects to:</span>
        <span class="value"><a href="{NODE.component.href}" class="link">{NODE.component.href}</a></span>

        <div class="component-actions">
            <button
                hx-get="/request/bo/component/x_redirect?edit=true&node_id={NODE.id}"
                hx-target="#edit-dialog .content"
                hx-indicator="#edit-loading"
                hx-trigger="click"
                hx-swap="innerHTML"
                hx-on::before-request="openDialog()"
                class="btn">
                Edit
            </button>
        </div>
    </fieldset>
    <!-- END: preview -->

    <!-- BEGIN: edit -->
    <script type="text/javascript">
        $(document).ready(function(){
            $('dialog #browse-server').click(function() {
                $('#href-select').addClass('ajax-load').load('/request/component/menu_js~id=0:expand_all=1:publish=0~', function() {
                    $('#href-select').removeClass('ajax-load');
                    $('#href-select .simple-tree').simpleTree({
                        drag: false,
                        autoclose: true,
                        afterClick:function(node){
                            var node_id = $('a:first', node).attr('href').match("[0-9]{1,}$");
                            $('#component-href').attr('value', '/page/' + node_id);
                        },
                        animate: true,
                        docToFolderConvert: true
                    });
                });
                return false;
            });
        });
    </script>

    <form id="qr-code-edit" class="qrcode">
        <h2>Redirect Edit</h2>

        <div class="row text">
            <label for="component-href">URL:</label>
            <input 
                type="text" 
                id="component-href" 
                name="node[component][href]" 
                value="{NODE.component.href}" 
            />
            <div class="additional-info">Insert parameters using pattern: parameter1=value1&amp;parameter2=value2...</div>
        </div>
        <a class="button" id="browse-server" href="#"><span>Browse Pages</span></a>
        <div id="href-select"></div>

        <input type="hidden" name="csrf_token" value="{CSRF_TOKEN}" />
        <input type="hidden" name="node[id]" value="{GET.node_id}" />

        <div class="edit-actions">
            <button 
                hx-indicator="#edit-loading"
                hx-post="/request/bo/component/x_redirect"
                class="btn" 
                type="submit" 
                name="save" 
                value="save" 
                id="saveAndClose"
            >
                Save & Close
            </button>

            <button class="btn secondary" type="button" onclick="closeDialog()">Cancel</button>
        </div>
    </form>
    <!-- END: edit -->
<!-- END: content -->
